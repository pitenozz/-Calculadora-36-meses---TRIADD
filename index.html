<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora 36 meses - TRIADD</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #e0f7fa, #f1f8e9);
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }
    .container {
      background: #fff;
      padding: 30px;
      margin-top: 40px;
      border-radius: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
      width: 600px;
      text-align: center;
    }
    h2 { color: #2c3e50; margin-bottom: 10px; font-weight: 600; }
    label { display: block; margin-top: 15px; font-weight: 600; color: #34495e; text-align: left; }
    input[type="date"] {
      padding: 10px; margin-top: 5px; width: 100%;
      border: 1px solid #ccc; border-radius: 8px; font-size: 14px;
    }
    button {
      margin-top: 15px; padding: 12px 18px; border: none; border-radius: 8px;
      background: #3498db; color: #fff; font-weight: 600; cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover { background: #2980b9; transform: scale(1.05); }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 8px; overflow: hidden; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; font-size: 14px; }
    th { background: #3498db; color: #fff; }
    tr:nth-child(even) { background: #f9f9f9; }
    tr:nth-child(odd) { background: #eef7fb; }
    .card { background: #ecf0f1; padding: 15px; border-radius: 10px; margin-top: 15px; font-size: 15px; }
    .progress-container {
      width: 100%; background: #ddd; border-radius: 10px; margin-top: 20px;
      height: 30px; overflow: hidden; position: relative;
    }
    .progress-bar {
      height: 100%; width: 0%; text-align: center; color: #fff; font-weight: bold;
      line-height: 30px; transition: width 0.8s ease, background 0.5s ease;
    }
    .progress-text {
      position: absolute; width: 100%; text-align: center; top: 0; left: 0;
      line-height: 30px; font-weight: 600; color: #2c3e50;
    }
    footer { margin-top: 25px; font-size: 12px; color: #7f8c8d; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Calculadora 36 meses - TRIADD</h2>
    <label>Data inicial: <input type="date" id="dataInicial"></label>
    <label>Data final: <input type="date" id="dataFinal"></label>
    <button onclick="adicionarPeriodo()">Adicionar Per√≠odo</button>
    <button onclick="limpar()">Limpar</button>

    <div id="listaPeriodos">
      <h3>Per√≠odos adicionados:</h3>
      <table>
        <thead>
          <tr>
            <th>Data Inicial</th>
            <th>Data Final</th>
            <th>Per√≠odo</th>
            <th>Somat√≥rio Parcial</th>
          </tr>
        </thead>
        <tbody id="periodos"></tbody>
      </table>
    </div>

    <div id="resultado" class="card"></div>

    <div class="progress-container">
      <div id="progressBar" class="progress-bar"></div>
      <div id="progressText" class="progress-text">0% - Em andamento</div>
    </div>

    <footer>Desenvolvido por TRIADD Assessoria Financeira</footer>
  </div>

  <script>
    let totalDias = 0;
    let periodos = [];

    function parseDate(str) {
      if (!str || !/^\d{4}-\d{2}-\d{2}$/.test(str)) return null;
      const [y, m, d] = str.split('-').map(Number);
      return new Date(Date.UTC(y, m - 1, d));
    }

    // ‚úÖ Corre√ß√£o: soma +1 para incluir o dia inicial
    function diffDiasEntre(inicio, fim) {
      const msPorDia = 1000 * 60 * 60 * 24;
      const iUTC = Date.UTC(inicio.getUTCFullYear(), inicio.getUTCMonth(), inicio.getUTCDate());
      const fUTC = Date.UTC(fim.getUTCFullYear(), fim.getUTCMonth(), fim.getUTCDate());
      return Math.floor((fUTC - iUTC) / msPorDia) + 1;
    }

    function formatBR(date) {
      return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate())
             .toLocaleDateString('pt-BR');
    }

    function atualizarBarra(totalMeses) {
      const progresso = Math.min((Number(totalMeses) / 36) * 100, 100);
      const progressBar = document.getElementById("progressBar");
      const progressText = document.getElementById("progressText");
      progressBar.style.width = progresso + "%";

      if (progresso <= 50) progressBar.style.background = "#f1c40f";
      else if (progresso <= 75) progressBar.style.background = "#e67e22";
      else if (progresso < 100) progressBar.style.background = "#2ecc71";
      else progressBar.style.background = "#27ae60";

      progressText.textContent = progresso < 100 ? Math.floor(progresso) + "% - Em andamento" : "100% - Conclu√≠do";
    }

    function atualizarResultado() {
      const totalMeses = totalDias / 30.44;
      const totalAnos = totalDias / 365.25;
      const mesesFaltando = Math.max(36 - totalMeses, 0);
      const diasFaltando = Math.max(Math.floor((36 * 30.44) - totalDias), 0);

      const status = totalMeses >= 36
        ? "‚úÖ Requisito de 36 meses atingido!"
        : `‚è≥ Ainda faltam ${mesesFaltando.toFixed(1)} meses (${diasFaltando} dias).`;

      document.getElementById("resultado").innerHTML = `
        <strong>Total acumulado:</strong><br>
        üìÜ ${totalMeses.toFixed(1)} meses<br>
        üìÖ ${totalDias} dias<br>
        üéâ ${totalAnos.toFixed(1)} anos<br><br>
        ${status}
      `;

      atualizarBarra(totalMeses);
    }

    function adicionarPeriodo() {
      const inicioStr = document.getElementById("dataInicial").value;
      const fimStr = document.getElementById("dataFinal").value;
      const inicio = parseDate(inicioStr);
      const fim = parseDate(fimStr);

      if (!inicio || !fim || fim < inicio) {
        alert("Por favor, insira datas v√°lidas (a final deve ser posterior √† inicial).");
        return;
      }

      const duplicado = periodos.some(p => p.inicio === inicioStr && p.fim === fimStr);
      if (duplicado) {
        alert("Este per√≠odo j√° foi adicionado.");
        return;
      }

      const diffDias = diffDiasEntre(inicio, fim);
      if (!isFinite(diffDias) || diffDias <= 0) {
        alert("Per√≠odo inv√°lido. Verifique as datas.");
        return;
      }

      totalDias += diffDias;
      periodos.push({ inicio: inicioStr, fim: fimStr, dias: diffDias });

      const parcialMeses = totalDias / 30.44;
      const lista = document.getElementById("periodos");
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${formatBR(inicio)}</td>
        <td>${formatBR(fim)}</td>
        <td>${(diffDias / 30.44).toFixed(1)} meses
